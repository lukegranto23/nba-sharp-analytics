<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBA Sharp Analytics - Professional Betting Platform</title>
    <style>
        /* Design system CSS from previous version */
        :root {
            --color-background: #fcfcf9;
            --color-surface: #fffcfd;
            --color-text: #13343b;
            --color-primary: #21808d;
            --color-border: rgba(94, 82, 64, 0.2);
        }
        
        @media (prefers-color-scheme: dark) {
            :root {
                --color-background: #1f2121;
                --color-surface: #262828;
                --color-text: #f5f5f5;
                --color-primary: #32b8c6;
                --color-border: rgba(119, 124, 124, 0.3);
            }
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--color-background);
            color: var(--color-text);
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .status-banner {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .game-card {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .game-card:hover {
            transform: translateY(-2px);
        }
        
        .ev-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .ev-max { background: #22c55e; color: white; }
        .ev-strong { background: #84cc16; color: white; }
        .ev-solid { background: #eab308; color: black; }
        .ev-marginal { background: #f59e0b; color: black; }
        .ev-no { background: #ef4444; color: white; }
        
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 18px;
        }
        
        .error {
            background: #fee2e2;
            border: 1px solid #ef4444;
            padding: 20px;
            border-radius: 8px;
            color: #991b1b;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üèÄ NBA Sharp Analytics</h1>
        <p>Professional Betting Platform with Automated Daily Updates</p>
    </div>
    
    <div id="status" class="status-banner">
        <h2>üìä System Status</h2>
        <p id="status-message">Loading...</p>
    </div>
    
    <div id="app">
        <div class="loading">Loading today's NBA predictions...</div>
    </div>
    
    <script>
        const REPO = 'lukegranto23/nba-sharp-analytics';
        const BRANCH = 'main';
        const BASE_URL = `https://raw.githubusercontent.com/${REPO}/${BRANCH}`;
        
        async function fetchData(file) {
            try {
                const response = await fetch(`${BASE_URL}/data/${file}`);
                if (!response.ok) throw new Error(`Failed to fetch ${file}`);
                return await response.json();
            } catch (error) {
                console.error(`Error fetching ${file}:`, error);
                return null;
            }
        }
        
        async function loadApp() {
            try {
                // Load all data
                const [performance, predictions, games] = await Promise.all([
                    fetchData('performance.json'),
                    fetchData('predictions.json'),
                    fetchData('todays_games.json')
                ]);
                
                // Update status
                const statusEl = document.getElementById('status-message');
                if (performance) {
                    if (performance.status === 'NEW MODEL') {
                        statusEl.innerHTML = `
                            <strong>üÜï ${performance.message}</strong><br>
                            <small>Last Updated: ${new Date(performance.last_updated).toLocaleString()}</small>
                        `;
                    } else {
                        statusEl.innerHTML = `
                            <strong>üìà Live Performance</strong><br>
                            Record: ${performance.correct}-${performance.incorrect} (${performance.accuracy_percent}% accurate)<br>
                            <small>Updated: ${new Date(performance.last_updated).toLocaleString()}</small>
                        `;
                    }
                }
                
                // Display predictions
                const appEl = document.getElementById('app');
                
                if (!predictions || predictions.length === 0) {
                    appEl.innerHTML = `
                        <div class="status-banner">
                            <h2>‚è∞ No Games Scheduled</h2>
                            <p>Next update: Tomorrow at 9:00 AM ET</p>
                            <p>The system automatically fetches new NBA games every morning.</p>
                        </div>
                    `;
                    return;
                }
                
                appEl.innerHTML = '<h2>üî• Today\'s Predictions</h2>';
                
                predictions.forEach(pred => {
                    const evClass = 
                        pred.ev_percent >= 15 ? 'ev-max' :
                        pred.ev_percent >= 10 ? 'ev-strong' :
                        pred.ev_percent >= 5 ? 'ev-solid' :
                        pred.ev_percent >= 0 ? 'ev-marginal' : 'ev-no';
                    
                    const card = document.createElement('div');
                    card.className = 'game-card';
                    card.innerHTML = `
                        <h3>${pred.away_team} @ ${pred.home_team}</h3>
                        <p><strong>Prediction:</strong> ${pred.prediction} (${pred.confidence}% confidence)</p>
                        <p><span class="ev-badge ${evClass}">EV: ${pred.ev_percent > 0 ? '+' : ''}${pred.ev_percent.toFixed(1)}%</span></p>
                        <details>
                            <summary>View Model Breakdown</summary>
                            <ul>
                                <li>Sully Four Factors: ${(pred.models.sully_four_factors * 100).toFixed(1)}%</li>
                                <li>Net Rating: ${(pred.models.net_rating * 100).toFixed(1)}%</li>
                                <li>ELO: ${(pred.models.elo * 100).toFixed(1)}%</li>
                                <li>Pythagorean: ${(pred.models.pythagorean * 100).toFixed(1)}%</li>
                                <li>Ensemble: ${(pred.models.ensemble * 100).toFixed(1)}%</li>
                            </ul>
                        </details>
                    `;
                    appEl.appendChild(card);
                });
                
            } catch (error) {
                console.error('Error loading app:', error);
                document.getElementById('app').innerHTML = `
                    <div class="error">
                        <h2>‚ö†Ô∏è Error Loading Data</h2>
                        <p>${error.message}</p>
                        <p>The automated system may still be initializing. Check back in a few minutes.</p>
                    </div>
                `;
            }
        }
        
        // Load app on page load
        loadApp();
        
        // Refresh every 5 minutes
        setInterval(loadApp, 5 * 60 * 1000);
    </script>
</body>
</html>